# Сервис управления рассылками сообщений, администрирования и получения статистики по ним


[1. Цель проекта](#title1) / 
[2. Шаблоны страниц](#title2) / 
[3. Модели](#title3) / 
[4. Админки](#title4) / 
[5. Формы](#title5) / 
[6. Контроллеры](#title6) / 

[8. Установка проекта](#title8) / 
[9. Получение ключей .env](#title9) / 
[10. Описание файла .flake8](#title10) / 
[11. Описание файла mypy.ini](#title11) / 
[12. Описание директории Data](#title12) / 




# <a id="title1">1. Цель проекта</a>
Чтобы удержать текущих клиентов бизнеса, часто используются вспомогательные, или "прогревающие" рассылки для информирования и привлечения.

Необходимо создать веб-приложение на Django, которое позволяет пользователям управлять рассылками сообщений для клиентов. Приложение включает функциональность для создания, просмотра, редактирования и удаления рассылок, а также отправки сообщений по требованию.




# <a id="title2">2. Шаблоны html-страниц (templates)</a>

## _Приложение "app_mailing" (app_mailing/templates/):_

Реализованы следующие HTML-страницы:

1) `Шаблонные страницы:`
   - ***base.html***: общий (базовый) шаблон для всех пользовательских страниц, который включает общие элементы страницы, такие как шапка, подвал и стили.
   - ***menu.html***: подшаблон, в котором описано главное меню:
     - ссылки для всех пользовательских страниц (навигация между разделами магазина).
     - блок с кнопками аутентификации ("Регистрация", "Войти", "Выйти", "Редактировать профиль", "Изменить пароль") и логикой их отображения в зависимости от текущего состояния пользователя (авторизован или нет).

2) `Пользовательские страницы:`
   - ***recipient_list.html***: страница для отображения всех Получателей в сервисе управления рассылками (модель данных **Recipient**).
     - Функционал страницы:
       - Добавить нового получателя.
       - Отредактировать получателя.
       - Удалить получателя.




# <a id="title3">3. Описание моделей (models)</a>

## _Приложение "app_mailing" (app_mailing/models.py):_

1) Модель данных `Recipient(models.Model)` - представляет "Получателя рассылки" в сервисе управления рассылками.
   - ***Поля модели:***
     - Почта получателя (email).
     - Ф.И.О. получателя (full_name).
     - Комментарий (comment).

2) Модель данных `Message(models.Model)` - представляет "Сообщение рассылки" в сервисе управления рассылками.
   - ***Поля модели:***
     - Тема письма (message_subject).
     - Тело письма (message_body).

3) Модель данных `Mailing(models.Model)` - представляет "Рассылку" в сервисе управления рассылками.
   - ***Поля модели:***
     - Дата и время первой отправки (first_message_sending).
     - Дата и время окончания отправки (end_message_sending).
     - Статус рассылки (status):
       - Доступные варианты статусов:
         - *Создана* - рассылка была создана, но еще ни разу не была отправлена.
         - *Запущена* - рассылка активна и была отправлена хотя бы один раз.
         - *Завершена* - время окончания отправки рассылки прошло.
     - Сообщение для рассылки (message) - внешний ключ на модель "Сообщение" (*models.ForeignKey(to=Message)*).
     - Получатели для рассылки (mailing_recipients) - "многие ко многим", связь с моделью "Получатель" (*models.ManyToManyField(to=Recipient)*).




# <a id="title4">4. Описание админок (admin)</a>

## _Приложение "app_mailing" (app_mailing/admin.py):_

1) Админка `RecipientAdmin(admin.ModelAdmin)` - отображение данных "Получатель рассылки" в админке (модель *Recipient*).

2) Админка `MessageAdmin(admin.ModelAdmin)` - отображение данных "Сообщение рассылки" в админке (модель *Message*).

3) Админка `MailingAdmin(admin.ModelAdmin)` - отображение данных "Рассылка" в админке (модель *Mailing*).




# <a id="title5">5. Описание форм (forms)</a>

## _Приложение "app_mailing" (app_mailing/forms.py):_

1) `AddNewRecipientForm(forms.ModelForm)` - форма для добавления пользователем нового Получателя рассылки на странице recipient_form_add_new.html
   - ***Кастомизация формы***:
     - `def __init__()` - стилизации полей формы с использованием виджета. Виджеты позволяют настроить внешний вид и поведение полей формы через атрибуты. Это делается с помощью метода attrs.
       - Добавляем CSS-классы ко всем полям формы.
       - Убираем параметр 'help_text' со всех полей, чтоб этого больше не было по умолчанию на html-странице.




# <a id="title6">6. Описание контроллеров (views)</a>

## _Приложение "app_mailing" (app_mailing/views.py):_

1) Класс-контроллер `RecipientListView(generic.ListView)` - представление для отображения страницы *recipient_list.html* со списком Получателей рассылки.




# <a id="title8">8. Установка проекта</a>

1. Клонируйте репозиторий:
   ```
   git clone https://github.com/MaksimLakovich/Coursework-4-Mailing-management-service.git
   ```
2. Установите зависимости:
   ```
   poetry install
   ```
3. Заполните файл `.env` по примеру `.env.example`




# <a id="title9">9. Получение ключей. Описание файла .env.example</a> 

1. Создайте файл .env в корне проекта из копии подготовленного файла `.env.example`, в котором описаны названия всех переменных, необходимых для работы приложения.
2. Замените значения переменных реальными данными.
3. В модуле `settings.py` существует секретный ключ `SECRET_KEY`, который рекомендуется в целях безопасности хранить в тайне:
4. Файл .env должен содержать данные:
```dotenv
# Настройки секретного ключа проекта django в config/settings.py
#Django рекомендует в целях безопасности хранить секретный ключ, используемый в продакшене, в тайне!
SECRET_KEY_FOR_PROJECT=secret_key_here

# Настройки дебага.
# В settings.py дебаг должен быть описан так: DEBUG = True if os.getenv('DEBUG') == 'True' else False
DEBUG=

# Настройки БД проекта django в config/settings.py
DATABASE_NAME=
DATABASE_USER=
DATABASE_PASSWORD=
DATABASE_HOST=
DATABASE_PORT=
```




# <a id="title10">10. Описание файла .flake8</a> 

```ini
[flake8]
max-line-length = 119
ignore = E203, W503
exclude = .git, __pycache__, venv, .venv
```




# <a id="title11">11. Описание файла mypy.ini</a> 

```ini
[mypy]
ignore_missing_imports = True
```




# <a id="title12">12. Описание директории data/</a> 

- Папка ***data/fixtures/***:
  - файл `add_recipients.json` - фикстура с тестовыми получателями рассылок.